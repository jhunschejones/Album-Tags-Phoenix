document.addEventListener("click",function(a){a=a.target.parentNode;(a.classList&&a.classList.contains("toast")||"toast-container"==a.id)&&closeToast()});function closeToast(){var a=document.querySelector(".toast");M.Toast.getInstance(a).dismiss()}function stringToNode(a){var b=document.createElement("template");b.innerHTML=a;return b.content.firstChild}function addEventListenerToClass(a,b,c){a=document.getElementsByClassName(a);for(var d=0;d<a.length;d++)a[d].addEventListener(b,c)}var spinner=document.getElementById("spinner-container");
function hideSpinner(){spinner.classList.contains("hide")||spinner.classList.add("hide")}function showSpinner(){spinner.classList.remove("hide")}function removeSelectedElement(a){if("."===a[0]){a=document.querySelectorAll(a);for(var b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b])}else"#"===a[0]?(a=document.getElementById(a.substring(1)))&&a.parentNode.removeChild(a):console.error("removeSelectedElement() was passed an invalid selector")}document.getElementById("connection-search-input").focus();
document.getElementById("connection-search-input").addEventListener("keydown",function(a){if(13==a.keyCode){removeSelectedElement(".album");removeSelectedElement("#warning");showSpinner();a=document.getElementById("connection-search-input").value.trim();var b=new XMLHttpRequest;b.onreadystatechange=function(){4===b.readyState&&(200<=b.status&&300>b.status?displayResults(JSON.parse(b.responseText)):(hideSpinner(),console.log("error",b)))};b.open("GET","/api/apple/search/?search_string="+a+"&offset=0");
b.send()}});document.getElementById("clear-search-input-btn").addEventListener("click",function(a){a=document.getElementById("connection-search-input");a.value="";a.focus()});
function displayResults(a){var b=document.getElementById("connection-search-results");if(1>a.albums.length)return hideSpinner(),b.appendChild(stringToNode('<div id="warning" style="width:100%;margin-top:25px;" class="center-align">\n        <em class="grey-text text-darken-1">\n          No albums match your search! Try another artist or album.\n        </em>\n      </div>'));hideSpinner();for(var c=0;c<a.albums.length;c++){var d=a.albums[c],e=d.cover.replace("{w}","200").replace("{h}","200");b.appendChild(stringToNode('<div class="album" onclick="addConnection('+
d.appleAlbumID+')">\n        <img class="responsive-img album-cover" src="'+e+'">\n        <p class="title">'+d.title+'</p>\n        <p class="artist grey-text text-darken-1">'+d.artist+"</p>\n      </div>"))}}
function addConnection(a){var b=parseInt((new URLSearchParams(window.location.search)).get("parent_album")),c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState)if(200<=c.status&&300>c.status){var a=JSON.parse(c.responseText).message;M.toast({html:a})}else a=JSON.parse(c.responseText).message,M.toast({html:a})};c.open("POST","/connections");c.setRequestHeader("Content-Type","application/json");c.setRequestHeader("X-CSRF-Token",CSRF_TOKEN);c.send(JSON.stringify({parentAlbum:b,childAlbum:a}))}
;
