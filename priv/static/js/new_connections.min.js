var connectionsPage={closeToast:function(){var a=document.querySelector(".toast");M.Toast.getInstance(a).dismiss()},closeToastsOnClick:function(a){a=a.target.parentNode;(a.classList&&a.classList.contains("toast")||"toast-container"==a.id)&&connectionsPage.closeToast()},hideSpinner:function(){connectionsPage.spinner.classList.contains("hide")||connectionsPage.spinner.classList.add("hide")},showSpinner:function(){connectionsPage.spinner.classList.remove("hide")},executeAlbumSearch:function(){removeSelectedElement(".album");
removeSelectedElement("#warning");connectionsPage.showSpinner();var a=connectionsPage.searchInput.value.trim(),c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&(200<=c.status&&300>c.status?connectionsPage.displaySearchResults(JSON.parse(c.responseText)):(connectionsPage.hideSpinner(),console.log("error",c)))};c.open("GET","/api/apple/search/?search_string="+a+"&offset=0");c.send()},clearSearchInput:function(){connectionsPage.searchInput.value="";connectionsPage.searchInput.focus()},
displaySearchResults:function(a){var c=document.getElementById("connection-search-results");if(1>a.albums.length)return connectionsPage.hideSpinner(),c.appendChild(stringToNode('<div id="warning" style="width:100%;margin-top:25px;" class="center-align">\n          <em class="grey-text text-darken-1">\n            No albums match your search! Try another artist or album.\n          </em>\n        </div>'));connectionsPage.hideSpinner();for(var b=0;b<a.albums.length;b++){var d=a.albums[b],e=d.cover.replace("{w}",
"200").replace("{h}","200");c.appendChild(stringToNode('<div class="album" onclick="connectionsPage.addConnection('+d.appleAlbumID+')">\n          <img class="responsive-img album-cover" src="'+e+'">\n          <p class="title">'+d.title+'</p>\n          <p class="artist grey-text text-darken-1">'+d.artist+"</p>\n        </div>"))}},addConnection:function(a){var c=parseInt((new URLSearchParams(window.location.search)).get("parent_album")),b=new XMLHttpRequest;b.onreadystatechange=function(){if(4===
b.readyState)if(200<=b.status&&300>b.status){var a=JSON.parse(b.responseText).message;M.toast({html:a})}else a=JSON.parse(b.responseText).message,M.toast({html:a})};b.open("POST","/connections");b.setRequestHeader("Content-Type","application/json");b.setRequestHeader("X-CSRF-Token",CSRF_TOKEN);b.send(JSON.stringify({parentAlbum:c,childAlbum:a}))}};function addEventListenerToClass(a,c,b){a=document.getElementsByClassName(a);for(var d=0;d<a.length;d++)a[d].addEventListener(c,b)}
document.addEventListener("DOMContentLoaded",function(){connectionsPage.spinner=document.getElementById("spinner-container");connectionsPage.searchInput=document.getElementById("connection-search-input");connectionsPage.clearSearchInputBtn=document.getElementById("clear-search-input-btn");connectionsPage.searchInput.focus();connectionsPage.searchInput.addEventListener("keydown",function(a){13==a.keyCode&&connectionsPage.executeAlbumSearch()},{passive:!0});connectionsPage.clearSearchInputBtn.addEventListener("click",
connectionsPage.clearSearchInput);document.addEventListener("click",function(a){connectionsPage.closeToastsOnClick(a)},{passive:!0})},{passive:!0});
