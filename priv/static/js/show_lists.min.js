var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Object.is",function(a){return a?a:function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,b){var c=this;c instanceof String&&(c=String(c));var e=c.length;b=b||0;for(0>b&&(b=Math.max(b+e,0));b<e;b++){var f=c[b];if(f===a||Object.is(f,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,c,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6","es3");
$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).i}},"es6","es3");
document.addEventListener("DOMContentLoaded",function(){if(document.getElementById("remove-album")){var a=document.getElementById("edit-list-modal");window.editListModal=M.Modal.init(a,{onOpenEnd:function(){var a=document.getElementById("list-name-input");a.focus();a.selectionStart=a.selectionEnd=a.value.length}});document.getElementById("edit-list").addEventListener("click",function(){window.editListModal.open()});document.getElementById("clear-list-name-input-btn").addEventListener("click",function(a){a=
document.getElementById("list-name-input");a.value="";a.focus()});a=document.getElementById("add-album-modal");window.addAlbumModal=M.Modal.init(a,{onOpenEnd:function(){document.getElementById("add-album-input").focus()}});document.getElementById("add-album").addEventListener("click",function(){window.addAlbumModal.open()});document.getElementById("clear-add-album-input-btn").addEventListener("click",function(a){a=document.getElementById("add-album-input");a.value="";a.focus()})}});
document.addEventListener("DOMContentLoaded",function(){document.addEventListener("click",function(a){if((a=a.target.parentNode)&&a.classList&&a.classList.contains("toast")||a&&"toast-container"==a.id)a=document.querySelector(".toast"),M.Toast.getInstance(a).dismiss()});var a=document.getElementById("lists-fab-button"),c=M.FloatingActionButton.init(a,{direction:"top",hoverEnabled:!1});document.addEventListener("click",function(a){a.target.parentNode&&(["show-buttons","add-lists","edit-lists","remove-album",
"filter-fab"].includes(a.target.parentNode.id)||c.close())},{passive:!0});document.getElementById("show-filters").addEventListener("click",function(){setTimeout(function(){document.getElementById("bottom-filters").classList.remove("hide")},150)},{passive:!0});document.getElementById("clear-all-filters").addEventListener("click",function(){listVueApp.yearFilters=[];listVueApp.artistFilters=[];listVueApp.tagFilters=[];listVueApp.resetSelectedAlbums();filterAll();hilightSelectedArtistFilters();hilightSelectedTagFilters();
hilightSelectedYearFilters();document.getElementById("bottom-filters").classList.add("hide");M.toast({html:"All filters cleared",displayLength:2500})},{passive:!0});document.getElementById("close-filter-menu").addEventListener("click",function(){document.getElementById("bottom-filters").classList.add("hide")},{passive:!0});document.addEventListener("scroll",function(){setTimeout(function(){document.getElementById("bottom-filters").classList.add("hide")},50)},{passive:!0});a=document.getElementById("year-filter-modal");
window.yearFilterModal=M.Modal.init(a,{onCloseStart:function(){listVueApp.resetSelectedAlbums();filterAll()}});document.getElementById("year-filter-btn").addEventListener("click",function(){hilightSelectedYearFilters();window.yearFilterModal.open()});a=document.getElementById("artist-filter-modal");window.artistFilterModal=M.Modal.init(a,{onCloseStart:function(){listVueApp.resetSelectedAlbums();filterAll()}});document.getElementById("artist-filter-btn").addEventListener("click",function(){hilightSelectedArtistFilters();
window.artistFilterModal.open()});a=document.getElementById("tag-filter-modal");window.tagFilterModal=M.Modal.init(a,{onCloseStart:function(){listVueApp.resetSelectedAlbums();filterAll()}});document.getElementById("tag-filter-btn").addEventListener("click",function(){hilightSelectedTagFilters();window.tagFilterModal.open()})});function showClass(a){a=document.getElementsByClassName(a);for(var c=0;c<a.length;c++)a[c].classList.remove("hide")}
function hideClass(a){a=document.getElementsByClassName(a);for(var c=0;c<a.length;c++)a[c].classList.add("hide")}function removeSelectedElement(a){if("."===a[0]){a=document.querySelectorAll(a);for(var c=0;c<a.length;c++)a[c].parentNode.removeChild(a[c])}else"#"===a[0]?(a=document.getElementById(a.substring(1)))&&a.parentNode.removeChild(a):console.error("removeSelectedElement() was passed an invalid selector")}
function stringToNode(a){var c=document.createElement("template");c.innerHTML=a;return c.content.firstChild}function addEventListenerToClass(a,c,b){a=document.getElementsByClassName(a);for(var d=0;d<a.length;d++)a[d].addEventListener(c,b)}window.showRemoveAlbum=!1;
function toggleRemoveAlbumButtons(){window.showRemoveAlbum?(window.showRemoveAlbum=!1,hideClass("delete-button")):(window.showRemoveAlbum=!0,showClass("delete-button"),M.toast({html:"Click the 'X' to remove an album from the list",displayLength:2500}))}document.getElementById("remove-album").addEventListener("click",toggleRemoveAlbumButtons);
function addAlbumToList(a){var c=parseInt(window.location.pathname.replace("/lists/","")),b=new XMLHttpRequest;b.onreadystatechange=function(){if(4===b.readyState)if(200<=b.status&&300>b.status){var a=JSON.parse(b.responseText);listVueApp.albums.push(a.added_album);window.showRemoveAlbum=!0;toggleRemoveAlbumButtons();window.addAlbumModal.close()}else M.toast({html:b.responseText.replace(/"/g,"")})};b.open("PATCH","/lists/"+c);b.setRequestHeader("Content-Type","application/json");b.setRequestHeader("X-CSRF-Token",
CSRF_TOKEN);b.send(JSON.stringify({action:"add_album",currentAlbum:a}))}
function removeAlbumFromList(a){if(confirm("Are you sure you want to remove the album from this list? You cannot undo this operation.")){var c=parseInt(window.location.pathname.replace("/lists/","")),b=new XMLHttpRequest;b.onreadystatechange=function(){if(4===b.readyState)if(200<=b.status&&300>b.status){var c=listVueApp.albums.findIndex(function(b){return b.id==a});listVueApp.albums.splice(c,1);M.toast({html:b.responseText.replace(/"/g,"")})}else M.toast({html:"Unable to remove album from list"})};
b.open("PATCH","/lists/"+c);b.setRequestHeader("Content-Type","application/json");b.setRequestHeader("X-CSRF-Token",CSRF_TOKEN);b.send(JSON.stringify({action:"remove_album",albumID:a}))}}
function updateListTitle(){var a=parseInt(window.location.pathname.replace("/lists/","")),c=document.getElementById("list-name-input").value.trim(),b=new XMLHttpRequest;b.onreadystatechange=function(){if(4===b.readyState)if(200<=b.status&&300>b.status){var a=JSON.parse(b.responseText);listVueApp.listTitle=a.list_title;window.editListModal.close();M.toast({html:a.message})}else M.toast({html:b.responseText.replace(/"/g,"")})};b.open("PATCH","/lists/"+a);b.setRequestHeader("Content-Type","application/json");
b.setRequestHeader("X-CSRF-Token",CSRF_TOKEN);b.send(JSON.stringify({action:"update_title",newTitle:c}))}document.getElementById("list-name-input").addEventListener("keyup",function(a){13===a.keyCode&&updateListTitle()});var albumSearchSpinner=document.getElementById("add-album-search-spinner-container");function hideAlbumSearchSpinner(){albumSearchSpinner.classList.contains("hide")||albumSearchSpinner.classList.add("hide")}
function showAlbumSearchSpinner(){albumSearchSpinner.classList.remove("hide")}
document.getElementById("add-album-input").addEventListener("keydown",function(a){if(13==a.keyCode){removeSelectedElement(".album-search-album");document.getElementById("add-album-search-results").style.display="inline-flex";removeSelectedElement("#add-album-search-result-warning");showAlbumSearchSpinner();a=document.getElementById("add-album-input").value.trim();var c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&(200<=c.status&&300>c.status?displayAlbumSearchResults(JSON.parse(c.responseText)):
(hideAlbumSearchSpinner(),console.log("error",c)))};c.open("GET","/api/apple/search/?search_string="+a+"&offset=0");c.send()}});
function displayAlbumSearchResults(a){var c=document.getElementById("add-album-search-results");if(1>a.albums.length)return hideAlbumSearchSpinner(),c.appendChild(stringToNode('<div id="add-album-search-result-warning" class="center-align">\n        <em class="grey-text text-darken-1">\n          No albums match your search! Try another artist or album.\n        </em>\n      </div>')),document.getElementById("add-album-search-results").style.display="block";hideAlbumSearchSpinner();document.getElementById("add-album-search-results").style.display=
"inline-flex";for(var b=0;b<a.albums.length;b++){var d=a.albums[b],e=d.cover.replace("{w}","230").replace("{h}","230");c.appendChild(stringToNode('<div class="album-search-album" onclick="addAlbumToList('+d.appleAlbumID+')">\n        <img class="search-album-cover" src="'+e+'">\n        <p class="search-title">'+d.title+'</p>\n        <p class="search-artist grey-text text-darken-1">'+d.artist+"</p>\n      </div>"))}}
function selectChip(a){a.classList.add("light-blue");a.classList.add("accent-4");a.classList.add("white-text")}function deselectChip(a){a.classList.remove("light-blue");a.classList.remove("accent-4");a.classList.remove("white-text")}function toggleChipSelect(a){a.classList.toggle("light-blue");a.classList.toggle("accent-4");a.classList.toggle("white-text")}
function selectYearFilter(a){toggleChipSelect(a.target);var c=listVueApp.yearFilters.indexOf(a.target.dataset.year);-1==c?listVueApp.yearFilters.push(a.target.dataset.year):listVueApp.yearFilters.splice(c,1)}function selectArtistFilter(a){toggleChipSelect(a.target);var c=listVueApp.artistFilters.indexOf(a.target.dataset.artist);-1==c?listVueApp.artistFilters.push(a.target.dataset.artist):listVueApp.artistFilters.splice(c,1)}
function selectTagFilter(a){toggleChipSelect(a.target);var c=listVueApp.tagFilters.indexOf(a.target.dataset.tag);-1==c?listVueApp.tagFilters.push(a.target.dataset.tag):listVueApp.tagFilters.splice(c,1)}
function removeFilter(a){var c=a.target.dataset.filter;switch(a.target.dataset.type){case "year":a=listVueApp.yearFilters.indexOf(c);listVueApp.yearFilters.splice(a,1);break;case "artist":a=listVueApp.artistFilters.indexOf(c);listVueApp.artistFilters.splice(a,1);break;case "tag":a=listVueApp.tagFilters.indexOf(c),listVueApp.tagFilters.splice(a,1)}listVueApp.resetSelectedAlbums();filterAll()}
function hilightSelectedTagFilters(){for(var a=document.getElementsByClassName("tag-filter"),c=listVueApp.tagFilters,b=0;b<a.length;b++){var d=a[b];c.includes(d.dataset.tag)?selectChip(d):deselectChip(d)}}function hilightSelectedArtistFilters(){for(var a=document.getElementsByClassName("artist-filter"),c=listVueApp.artistFilters,b=0;b<a.length;b++){var d=a[b];c.includes(d.dataset.artist)?selectChip(d):deselectChip(d)}}
function hilightSelectedYearFilters(){for(var a=document.getElementsByClassName("year-filter"),c=listVueApp.yearFilters,b=0;b<a.length;b++){var d=a[b];c.includes(d.dataset.year)?selectChip(d):deselectChip(d)}}function filterYears(){0!==listVueApp.yearFilters.length&&(listVueApp.selectedAlbums=listVueApp.selectedAlbums.filter(function(a){return listVueApp.yearFilters.includes(a.release_date.substr(0,4))}))}
function filterArtists(){0!==listVueApp.artistFilters.length&&(listVueApp.selectedAlbums=listVueApp.selectedAlbums.filter(function(a){return listVueApp.artistFilters.includes(a.artist)}))}function filterTags(){0!==listVueApp.tagFilters.length&&(listVueApp.selectedAlbums=listVueApp.selectedAlbums.filter(function(a){return listVueApp.tagFilters.every(function(c){return a.tags.map(function(a){return a.text}).includes(c)})}))}function filterAll(){filterYears();filterArtists();filterTags()}
addEventListenerToClass("filter-btn","click",function(a){window.yearFilterModal.close();window.artistFilterModal.close();window.tagFilterModal.close()});
addEventListenerToClass("clear-filters","click",function(a){switch(a.target.dataset.type){case "year":listVueApp.yearFilters=[];M.toast({html:"Year filters cleared",displayLength:2500});break;case "artist":listVueApp.artistFilters=[];M.toast({html:"Artist filters cleared",displayLength:2500});break;case "tag":listVueApp.tagFilters=[],M.toast({html:"Tag filters cleared",displayLength:2500})}listVueApp.resetSelectedAlbums();filterAll();hilightSelectedArtistFilters();hilightSelectedTagFilters();hilightSelectedYearFilters()});
