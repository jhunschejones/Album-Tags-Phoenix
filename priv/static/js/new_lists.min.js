function truncate(a,c){a=a.substr(0,c-1);return a.substr(0,a.lastIndexOf(" ")).replace(/(^[,\s]+)|([,\s]+$)/g,"")+"..."}
function initializeSelectElement(){var a=document.querySelectorAll("select");a=M.FormSelect.init(a,{});window.existingListSelect=a[0];window.existingListSelect.dropdown.options.onCloseStart=function(){var a=(document.getElementsByClassName("select-dropdown")[0].offsetWidth-30)/6.75,b=document.getElementsByClassName("select-dropdown")[0].value;b.length>a&&(document.getElementsByClassName("select-dropdown")[0].value=truncate(b,a))};document.addEventListener("click",function(a){a.target.classList.contains("select-dropdown")||
window.existingListSelect.dropdown.close()})}document.addEventListener("DOMContentLoaded",function(){initializeSelectElement()},{passive:!0});document.addEventListener("click",function(a){a=a.target.parentNode;(a.classList&&a.classList.contains("toast")||"toast-container"==a.id)&&closeToast()});function closeToast(){var a=document.querySelector(".toast");M.Toast.getInstance(a).dismiss()}
document.getElementById("add-to-list-btn").addEventListener("click",function(){var a=window.existingListSelect.getSelectedValues()[0];if(""!==a){if("favorites"===a)return addToFavorites();var c=parseInt((new URLSearchParams(window.location.search)).get("album")),b=new XMLHttpRequest;b.onreadystatechange=function(){4===b.readyState&&(window.existingListSelect.destroy(),document.getElementById("placeholder").selected=!0,initializeSelectElement(),M.toast({html:b.responseText.replace(/"/g,"")}))};b.open("PATCH",
"/lists/"+a);b.setRequestHeader("Content-Type","application/json");b.setRequestHeader("X-CSRF-Token",CSRF_TOKEN);b.send(JSON.stringify({action:"add_album",currentAlbum:c}))}},{passive:!0});
function addToFavorites(){var a=parseInt((new URLSearchParams(window.location.search)).get("album")),c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&(window.existingListSelect.destroy(),document.getElementById("placeholder").selected=!0,initializeSelectElement(),M.toast({html:c.responseText.replace(/"/g,"")}))};c.open("PATCH","/lists/favorites");c.setRequestHeader("Content-Type","application/json");c.setRequestHeader("X-CSRF-Token",CSRF_TOKEN);c.send(JSON.stringify({action:"add_favorite",
currentAlbum:a}))}
document.getElementById("add-to-new-list-btn").addEventListener("click",function(){var a=document.getElementById("new-list-name").value.trim(),c=parseInt((new URLSearchParams(window.location.search)).get("album")),b=new XMLHttpRequest;b.onreadystatechange=function(){4===b.readyState&&(200<=b.status&&300>b.status&&(document.getElementById("new-list-name").value=""),M.toast({html:b.responseText.replace(/"/g,"")}))};b.open("POST","/lists");b.setRequestHeader("Content-Type","application/json");b.setRequestHeader("X-CSRF-Token",
CSRF_TOKEN);b.send(JSON.stringify({currentAlbum:c,private:!1,title:a}))},{passive:!0});document.getElementById("new-list-name").addEventListener("keyup",function(a){13===a.keyCode&&document.getElementById("add-to-new-list-btn").click()});
